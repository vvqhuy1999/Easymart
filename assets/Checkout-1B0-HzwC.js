import{_ as ve,u as ye,p as be,r as b,q as C,h as ke,m as _e,c as i,a as e,d as f,i as A,j as E,k as Te,g as u,t as r,w as Pe,s as I,v as D,f as M,l as P,x as xe,F as R,e as J,y as ae,A as G,z as Ie,o as c}from"./index-wvKgaFqi.js";const we={class:"checkout-page"},Se={class:"container py-5 mt-5"},Ce={"aria-label":"breadcrumb",class:"mb-4"},Me={class:"breadcrumb"},Ne={class:"breadcrumb-item"},De={key:0,class:"breadcrumb-item"},Ve={key:1,class:"breadcrumb-item"},Ae={class:"d-flex justify-content-between align-items-center mb-4"},Ee={class:"mb-0"},Oe={key:0,class:"row"},Ue={class:"col-lg-8"},$e={class:"card mb-4"},He={class:"card-body"},Ge={class:"row"},Le={class:"col-md-6 mb-3"},Fe={key:0,class:"invalid-feedback"},je={class:"col-md-6 mb-3"},Be={key:0,class:"invalid-feedback"},Ke={class:"mb-3"},qe={key:0,class:"invalid-feedback"},Re={class:"mb-3"},Je={key:0,class:"invalid-feedback"},ze={class:"mb-3"},Ze={key:0,class:"mb-3"},We={class:"d-flex gap-2"},Qe={class:"card mb-4"},Ye={class:"card-body"},Xe={key:0,class:"text-center py-4"},et={key:1,class:"row"},tt={class:"form-check payment-method"},nt=["id","value"],ot=["for"],st={class:"d-flex align-items-center"},at={class:"text-muted small"},lt={key:0,class:"text-info small"},it={key:2,class:"alert alert-warning"},rt={key:3,class:"row"},ct={class:"col-md-6 mb-3"},ut={class:"form-check payment-method"},dt={key:4,class:"payment-info mt-3 p-3 bg-light rounded"},ht={class:"text-primary mb-3"},mt={class:"row"},gt={class:"col-md-6"},pt={class:"mb-2"},ft={class:"mb-2"},vt={key:0,class:"mb-2"},yt={class:"col-md-6"},bt={class:"mb-0 text-info"},kt={key:0,class:"banking-details mt-3 p-3 bg-white rounded border"},_t={class:"row"},Tt={class:"col-md-6"},Pt={class:"mb-1"},xt={class:"col-lg-4"},It={class:"card sticky-top",style:{top:"100px"}},wt={class:"card-body"},St={class:"order-items mb-3"},Ct=["src","alt"],Mt={class:"flex-grow-1"},Nt={class:"mb-1"},Dt={class:"d-flex justify-content-between"},Vt={class:"text-muted"},At={class:"fw-bold"},Et={class:"order-summary"},Ot={class:"d-flex justify-content-between mb-2"},Ut={key:0,class:"d-flex justify-content-between mb-2"},$t={class:"text-info"},Ht={class:"coupon-section mb-3"},Gt={class:"d-flex gap-2 mb-2"},Lt=["disabled"],Ft=["disabled"],jt={key:0},Bt={key:1},Kt={key:0,class:"applied-coupon"},qt={class:"d-flex justify-content-between align-items-center p-3 rounded-3",style:{background:"linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1))",border:"1px solid rgba(102, 126, 234, 0.3)"}},Rt={class:"fw-bold",style:{color:"#667eea"}},Jt={class:"small text-muted"},zt={key:1,class:"d-flex justify-content-between mb-2",style:{color:"#11998e"}},Zt={key:2,class:"available-coupons mt-2"},Wt={class:"d-flex flex-wrap gap-1"},Qt=["onClick","title"],Yt={class:"d-flex justify-content-between mb-3"},Xt={class:"text-danger fs-5"},en=["disabled"],tn={key:0},nn={key:1},on={key:1,class:"row"},sn={class:"col-12"},an={class:"empty-checkout text-center py-5"},ln={class:"text-muted mb-4"},rn={__name:"Checkout",setup(cn){const z=_e(),{formatPrice:_,showNotification:m,products:Z}=ye(),{cart:W,clearCart:le}=be(),{user:h,isLoggedIn:x}=xe(),Q=()=>{console.log("üîç Debug LocalStorage Data:"),console.log("   - easymart-invoice:",localStorage.getItem("easymart-invoice")),console.log("   - easymart-selected-items:",localStorage.getItem("easymart-selected-items")),console.log("   - easymart-cart:",localStorage.getItem("easymart-cart"));try{const n=JSON.parse(localStorage.getItem("easymart-invoice")||"null");n&&(console.log("   - Invoice parsed:",n),console.log("   - Invoice keys:",Object.keys(n)),console.log("   - chiTietHoaDon:",n.chiTietHoaDon),console.log("   - items:",n.items))}catch(n){console.error("   - Error parsing invoice:",n)}},O=n=>{if(!n)return"/placeholder-image.jpg";const t=Ie.IMAGES.PRODUCT_IMAGES(n);return t[0]?`${G.BASE_URL}${t[0]}`:"/placeholder-image.jpg"},Y=()=>{console.log("üîê Checking auth status..."),console.log("   - isLoggedIn:",x),console.log("   - user:",h),console.log("   - orderForm:",a),x&&typeof x.value<"u"?console.log("‚úÖ isLoggedIn is properly initialized"):console.log("‚ùå isLoggedIn is not properly initialized"),h&&typeof h.value<"u"?console.log("‚úÖ user is properly initialized"):console.log("‚ùå user is not properly initialized")},X=async()=>{try{if(!x||!x.value){console.log("‚ö†Ô∏è User ch∆∞a ƒëƒÉng nh·∫≠p ho·∫∑c isLoggedIn undefined"),L();return}if(!h||!h.value){console.log("‚ö†Ô∏è User object ch∆∞a s·∫µn s√†ng ho·∫∑c user undefined"),L();return}if(console.log("üë§ Pre-filling user info:",h.value),await ie(),h.value.name&&(a.value.fullName=h.value.name),h.value.email&&(a.value.email=h.value.email),h.value.customerInfo){const n=h.value.customerInfo;n.hoTen&&(a.value.fullName=n.hoTen),n.sdt&&(a.value.phone=n.sdt),n.diaChi&&(a.value.address=n.diaChi),n.nguoiDung?.email&&(a.value.email=n.nguoiDung.email)}console.log("‚úÖ Form ƒë√£ ƒë∆∞·ª£c pre-fill:",a.value)}catch(n){console.error("‚ùå L·ªói khi pre-fill user info:",n),console.log("üîç Debug info:",{isLoggedIn:x,user:h,orderForm:a}),L()}},L=()=>{try{console.log("üîÑ Trying fallback: getting user info from localStorage...");const n=localStorage.getItem("easymart-user");if(n){const t=JSON.parse(n);console.log("üì¶ Found user data in localStorage:",t),t.name&&(a.value.fullName=t.name),t.email&&(a.value.email=t.email),console.log("‚úÖ Fallback pre-fill successful")}else console.log("‚ö†Ô∏è No user data found in localStorage")}catch(n){console.error("‚ùå Fallback also failed:",n)}},ie=async()=>{try{console.log("üì° Fetching shipping info from Profile API..."),ne.value=!0;const n=h.value?.customerInfo?.maKH;if(!n){console.log("‚ö†Ô∏è No maKH found, cannot fetch shipping info");return}const t=ee();if(!t){console.log("‚ö†Ô∏è No token found, cannot fetch shipping info");return}const l=`${G.BASE_URL}/api/khachhang/${n}/info`;console.log("üîó Fetching from endpoint:",l);const o=await fetch(l,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!o.ok){console.log("‚ö†Ô∏è Profile API failed:",o.status);return}const s=await o.json();console.log("üì• Profile API response:",s);let d=null;s?.data?d=s.data:s?.result?d=s.result:s?.hoTen||s?.sdt||s?.diaChi?d=s:Array.isArray(s)&&(d=s[0]),d&&(console.log("‚úÖ Customer data received:",d),h.value?.customerInfo&&(h.value.customerInfo={...h.value.customerInfo,...d}),d.hoTen&&(a.value.fullName=d.hoTen),d.sdt&&(a.value.phone=d.sdt),d.diaChi&&(a.value.address=d.diaChi),d.nguoiDung?.email&&(a.value.email=d.nguoiDung.email),console.log("‚úÖ Shipping info updated from Profile API"))}catch(n){console.error("‚ùå Error fetching shipping info:",n)}finally{ne.value=!1}},re=async()=>{try{console.log("üì§ Updating shipping info to Profile API...");const n=h.value?.customerInfo?.maKH;if(!n)return console.log("‚ö†Ô∏è No maKH found, cannot update shipping info"),!1;const t=ee();if(!t)return console.log("‚ö†Ô∏è No token found, cannot update shipping info"),!1;const l={hoTen:a.value.fullName,sdt:a.value.phone,diaChi:a.value.address,email:a.value.email};console.log("üì§ Update data prepared:",l);const o=`${G.BASE_URL}/api/khachhang/${n}/update-info`;console.log("üîó Update endpoint:",o);const s=await fetch(o,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(l)});if(!s.ok){const q=await s.json().catch(()=>({}));return console.log("‚ö†Ô∏è Update failed:",s.status,q.message),!1}const d=await s.json();return console.log("üì• Update response:",d),d?.success||d?.result?.success||d?.message?.includes("th√†nh c√¥ng")?(console.log("‚úÖ Shipping info updated successfully"),h.value?.customerInfo&&(h.value.customerInfo={...h.value.customerInfo,hoTen:a.value.fullName,sdt:a.value.phone,diaChi:a.value.address}),!0):(console.log("‚ö†Ô∏è Update response format unexpected:",d),!1)}catch(n){return console.error("‚ùå Error updating shipping info:",n),!1}},ee=()=>document.cookie.split("; ").find(n=>n.startsWith("easymart-token="))?.split("=")[1],te=async()=>{try{console.log("üì° Fetching payment methods from API..."),F.value=!0,j.value="";const n=await fetch(`${G.BASE_URL}/api/phuongthucthanhtoan`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const t=await n.json();console.log("üì• Payment methods API response:",t);let l=[];if(t?.data)l=t.data;else if(t?.result)l=t.result;else if(Array.isArray(t))l=t;else throw new Error("Unexpected response format");const o=l.filter(s=>s.trangThai===1&&!s.isDeleted);console.log("‚úÖ Active payment methods:",o),$.value=o,o.length>0&&!a.value.paymentMethod&&(a.value.paymentMethod=o[0].tenPTTT)}catch(n){console.error("‚ùå Error fetching payment methods:",n),j.value="Kh√¥ng th·ªÉ t·∫£i ph∆∞∆°ng th·ª©c thanh to√°n: "+n.message}finally{F.value=!1}},ce=n=>({"Ti·ªÅn M·∫∑t":"fas fa-hand-holding-usd text-success","Chuy·ªÉn Kho·∫£n":"fas fa-university text-primary",MoMo:"fab fa-momo text-danger",ZaloPay:"fas fa-mobile-alt text-warning","Th·∫ª T√≠n D·ª•ng":"fas fa-credit-card text-info",VNPay:"fas fa-credit-card text-info"})[n]||"fas fa-credit-card text-secondary",ue=n=>({"Ti·ªÅn M·∫∑t":"B·∫°n s·∫Ω thanh to√°n b·∫±ng ti·ªÅn m·∫∑t khi nh·∫≠n h√†ng.","Chuy·ªÉn Kho·∫£n":"Vui l√≤ng chuy·ªÉn kho·∫£n theo th√¥ng tin ng√¢n h√†ng b√™n d∆∞·ªõi.",MoMo:"B·∫°n s·∫Ω ƒë∆∞·ª£c chuy·ªÉn ƒë·∫øn app MoMo ƒë·ªÉ ho√†n t·∫•t thanh to√°n.",ZaloPay:"B·∫°n s·∫Ω ƒë∆∞·ª£c chuy·ªÉn ƒë·∫øn app ZaloPay ƒë·ªÉ ho√†n t·∫•t thanh to√°n.","Th·∫ª T√≠n D·ª•ng":"B·∫°n s·∫Ω ƒë∆∞·ª£c chuy·ªÉn ƒë·∫øn c·ªïng thanh to√°n ƒë·ªÉ nh·∫≠p th√¥ng tin th·∫ª.",VNPay:"B·∫°n s·∫Ω ƒë∆∞·ª£c chuy·ªÉn ƒë·∫øn c·ªïng thanh to√°n VNPay ƒë·ªÉ ho√†n t·∫•t giao d·ªãch."})[n]||"Vui l√≤ng l√†m theo h∆∞·ªõng d·∫´n thanh to√°n.",U=b(!1),y=b(""),p=b({}),ne=b(!1),$=b([]),F=b(!1),j=b(""),w=b(""),g=b(null),H=b(!1),B=b([{code:"WELCOME10",description:"Gi·∫£m 10% cho ƒë∆°n h√†ng ƒë·∫ßu ti√™n",discountType:"percentage",discountValue:10,minOrderValue:1e5,maxDiscount:5e4},{code:"SAVE50K",description:"Gi·∫£m 50.000ƒë cho ƒë∆°n t·ª´ 500.000ƒë",discountType:"fixed",discountValue:5e4,minOrderValue:5e5,maxDiscount:5e4},{code:"VIP20",description:"Gi·∫£m 20% cho kh√°ch VIP (t·ªëi ƒëa 100k)",discountType:"percentage",discountValue:20,minOrderValue:2e5,maxDiscount:1e5}]),a=b({fullName:"",phone:"",email:"",address:"",notes:"",paymentMethod:"cod"}),v=b([]),N=C(()=>v.value.reduce((n,t)=>n+(t.product?.price||0)*t.quantity,0)),S=C(()=>{if(!g.value)return 0;const n=g.value,t=N.value;if(t<n.minOrderValue)return 0;let l=0;switch(n.discountType){case"percentage":l=t*n.discountValue/100;break;case"fixed":l=n.discountValue;break;case"shipping":l=0;break;default:l=0}return Math.min(l,n.maxDiscount)}),V=C(()=>{const n=k.value?.phiGiaoDich||0;return N.value-S.value+n}),K=C(()=>v.value.reduce((n,t)=>n+t.quantity,0)),de=C(()=>a.value.fullName&&a.value.phone&&a.value.address&&a.value.paymentMethod),k=C(()=>$.value.find(n=>n.tenpttt===a.value.paymentMethod)),T=C(()=>v.value.length===1&&!1),he=()=>{const n=Date.now().toString().slice(-6),t=Math.random().toString(36).substr(2,4).toUpperCase();return`EM${n}${t}`},me=()=>(p.value={},a.value.fullName.trim()||(p.value.fullName="Vui l√≤ng nh·∫≠p h·ªç v√† t√™n"),a.value.phone.trim()?/^[0-9]{10,11}$/.test(a.value.phone.replace(/\s/g,""))||(p.value.phone="S·ªë ƒëi·ªán tho·∫°i kh√¥ng h·ª£p l·ªá"):p.value.phone="Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i",a.value.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.value.email)&&(p.value.email="Email kh√¥ng h·ª£p l·ªá"),a.value.address.trim()||(p.value.address="Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ giao h√†ng"),Object.keys(p.value).length===0),oe=async()=>{if(w.value.trim()){H.value=!0;try{await new Promise(t=>setTimeout(t,1e3));const n=B.value.find(t=>t.code.toLowerCase()===w.value.trim().toLowerCase());if(!n){m("M√£ khuy·∫øn m√£i kh√¥ng h·ª£p l·ªá!","error");return}if(N.value<n.minOrderValue){m(`ƒê∆°n h√†ng t·ªëi thi·ªÉu ${_(n.minOrderValue)} ƒë·ªÉ √°p d·ª•ng m√£ n√†y!`,"warning");return}g.value=n,m(`√Åp d·ª•ng m√£ ${n.code} th√†nh c√¥ng!`,"success")}catch{m("C√≥ l·ªói x·∫£y ra khi √°p d·ª•ng m√£ khuy·∫øn m√£i!","error")}finally{H.value=!1}}},ge=()=>{g.value=null,w.value="",m("ƒê√£ x√≥a m√£ khuy·∫øn m√£i!","info")},pe=n=>{w.value=n,oe()},se=async()=>{if(!me()){m("Vui l√≤ng ki·ªÉm tra l·∫°i th√¥ng tin ƒë∆°n h√†ng","error");return}U.value=!0;try{x&&x.value&&h.value?.customerInfo?.maKH&&(console.log("üîÑ Auto-updating shipping info to Profile..."),await re()?m("Th√¥ng tin giao h√†ng ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t v√†o Profile!","success"):console.log("‚ö†Ô∏è Failed to update shipping info to Profile, continuing with order..."));const n=localStorage.getItem("easymart-invoice");let t;if(n){const l=JSON.parse(n);console.log("üìã C·∫≠p nh·∫≠t th√¥ng tin giao h√†ng cho h√≥a ƒë∆°n:",l.maHD),await new Promise(o=>setTimeout(o,1e3)),t={orderCode:`HD${l.maHD}`,invoiceId:l.maHD,customer:{...a.value},items:v.value,summary:{subtotal:N.value,couponDiscount:S.value,total:V.value,itemsCount:K.value},coupon:g.value?{code:g.value.code,description:g.value.description,discountType:g.value.discountType,discountValue:S.value}:null,createdAt:l.ngayLap||new Date().toISOString()}}else console.log("‚ö†Ô∏è Kh√¥ng c√≥ h√≥a ƒë∆°n, t·∫°o ƒë∆°n h√†ng m·ªõi"),await new Promise(l=>setTimeout(l,2e3)),t={orderCode:y.value,customer:{...a.value},items:v.value,summary:{subtotal:N.value,couponDiscount:S.value,total:V.value,itemsCount:K.value},coupon:g.value?{code:g.value.code,description:g.value.description,discountType:g.value.discountType,discountValue:S.value}:null,createdAt:new Date().toISOString()};console.log("üßπ Clearing cart after successful checkout...");try{await le(),console.log("‚úÖ Backend cart cleared successfully")}catch(l){console.warn("‚ö†Ô∏è Failed to clear backend cart:",l)}localStorage.removeItem("easymart-selected-items"),console.log("üßπ localStorage cleared"),fe(t)}catch{m("C√≥ l·ªói x·∫£y ra khi ƒë·∫∑t h√†ng. Vui l√≤ng th·ª≠ l·∫°i!","error")}finally{U.value=!1}},fe=n=>{const t=a.value.paymentMethod;switch(localStorage.setItem("easymart-last-order",JSON.stringify(n)),t){case"Ti·ªÅn M·∫∑t":m(`ƒê·∫∑t h√†ng th√†nh c√¥ng! M√£ ƒë∆°n h√†ng: ${y.value}. B·∫°n s·∫Ω thanh to√°n khi nh·∫≠n h√†ng.`,"success");break;case"Chuy·ªÉn Kho·∫£n":m(`ƒê·∫∑t h√†ng th√†nh c√¥ng! M√£ ƒë∆°n h√†ng: ${y.value}. Vui l√≤ng chuy·ªÉn kho·∫£n theo th√¥ng tin ƒë√£ cung c·∫•p.`,"success");break;case"MoMo":m("ƒêang chuy·ªÉn ƒë·∫øn MoMo ƒë·ªÉ thanh to√°n...","info"),setTimeout(()=>{m(`Thanh to√°n MoMo th√†nh c√¥ng! M√£ ƒë∆°n h√†ng: ${y.value}`,"success")},1500);break;case"ZaloPay":m("ƒêang chuy·ªÉn ƒë·∫øn ZaloPay ƒë·ªÉ thanh to√°n...","info"),setTimeout(()=>{m(`Thanh to√°n ZaloPay th√†nh c√¥ng! M√£ ƒë∆°n h√†ng: ${y.value}`,"success")},1500);break;case"Th·∫ª T√≠n D·ª•ng":m("ƒêang chuy·ªÉn ƒë·∫øn c·ªïng thanh to√°n...","info"),setTimeout(()=>{m(`Thanh to√°n th·∫ª t√≠n d·ª•ng th√†nh c√¥ng! M√£ ƒë∆°n h√†ng: ${y.value}`,"success")},1500);break;case"VNPay":m("ƒêang chuy·ªÉn ƒë·∫øn VNPay ƒë·ªÉ thanh to√°n...","info"),setTimeout(()=>{m(`Thanh to√°n VNPay th√†nh c√¥ng! M√£ ƒë∆°n h√†ng: ${y.value}`,"success")},1500);break;default:m(`ƒê·∫∑t h√†ng th√†nh c√¥ng! M√£ ƒë∆°n h√†ng: ${y.value}`,"success")}setTimeout(()=>{z.push({name:"PaymentSuccess",query:{orderCode:y.value,total:V.value,paymentMethod:t}})},3e3)};return ke(async()=>{console.log("üöÄ Checkout page mounted"),await te(),Q();const n=localStorage.getItem("easymart-invoice"),t=localStorage.getItem("easymart-selected-items");if(n&&t){const l=JSON.parse(n),o=JSON.parse(t);console.log("üìã Nh·∫≠n h√≥a ƒë∆°n:",l),console.log("üõí Selected items:",o),console.log("üîç Invoice structure:",Object.keys(l)),y.value=`HD${l.maHD||l.orderId||"NEW"}`,l.chiTietHoaDon&&l.chiTietHoaDon.length>0?(console.log("‚úÖ S·ª≠ d·ª•ng chiTietHoaDon t·ª´ Orders.vue"),v.value=l.chiTietHoaDon.map(s=>({productId:s.maSP||s.productId,quantity:s.soLuong||s.quantity,product:{id:s.maSP||s.productId,name:s.tenSP||s.productName,price:s.donGiaBan||s.donGia||s.productPrice,image:O(s.maSP||s.productId)}}))):l.items&&l.items.length>0?(console.log("‚úÖ S·ª≠ d·ª•ng items t·ª´ Cart.vue/ProductDetail"),v.value=l.items.map(s=>({productId:s.maSP||s.productId,quantity:s.soLuong||s.quantity,product:{id:s.maSP||s.productId,name:s.tenSP||s.productName,price:s.donGiaBan||s.donGia||s.productPrice,image:O(s.maSP||s.productId)}}))):(console.log("‚ö†Ô∏è Kh√¥ng c√≥ items trong h√≥a ƒë∆°n, th·ª≠ fallback..."),v.value=W.value.filter(s=>o.includes(s.productId)).map(s=>{const d=Z.value.find(q=>q.id===s.productId);return d&&(d.image=O(s.productId)),{...s,product:d}}).filter(s=>s.product)),Y(),await X()}else{if(y.value=he(),t){const l=JSON.parse(t);v.value=W.value.filter(o=>l.includes(o.productId)).map(o=>{const s=Z.value.find(d=>d.id===o.productId);return s&&(s.image=O(o.productId)),{...o,product:s}}).filter(o=>o.product)}Y(),await X()}console.log("üìä Final selectedItems state:"),console.log("   - Length:",v.value.length),console.log("   - Items:",v.value),console.log("   - Invoice data:",n?JSON.parse(n):"None"),console.log("   - Stored selected items:",t),v.value.length===0?(console.warn("‚ö†Ô∏è No selected items found, redirecting to cart..."),m("Vui l√≤ng ch·ªçn s·∫£n ph·∫©m t·ª´ gi·ªè h√†ng ƒë·ªÉ thanh to√°n","warning"),setTimeout(()=>{z.push("/cart")},2e3)):console.log("‚úÖ Selected items loaded successfully, staying on checkout page")}),(n,t)=>{const l=Te("router-link");return c(),i("div",we,[e("div",Se,[e("nav",Ce,[e("ol",Me,[e("li",Ne,[A(l,{to:"/",class:"text-decoration-none"},{default:E(()=>t[8]||(t[8]=[e("i",{class:"fas fa-home"},null,-1),u(" Trang ch·ªß ")])),_:1,__:[8]})]),T.value?f("",!0):(c(),i("li",De,[A(l,{to:"/cart",class:"text-decoration-none"},{default:E(()=>t[9]||(t[9]=[e("i",{class:"fas fa-shopping-cart"},null,-1),u(" Gi·ªè h√†ng ")])),_:1,__:[9]})])),T.value?(c(),i("li",Ve,t[10]||(t[10]=[e("span",{class:"text-muted"},[e("i",{class:"fas fa-bolt"}),u(" Mua ngay ")],-1)]))):f("",!0),t[11]||(t[11]=e("li",{class:"breadcrumb-item active","aria-current":"page"},[e("i",{class:"fas fa-credit-card"}),u(" Thanh to√°n ")],-1))])]),e("div",Ae,[e("h2",Ee,[t[12]||(t[12]=e("i",{class:"fas fa-credit-card text-primary me-2"},null,-1)),u(" "+r(T.value?"Thanh to√°n mua ngay":"Thanh to√°n ƒë∆°n h√†ng"),1)]),e("div",{class:"d-flex gap-2"},[e("button",{onClick:Q,class:"btn btn-outline-warning btn-sm",title:"Debug localStorage data"},t[13]||(t[13]=[e("i",{class:"fas fa-bug me-1"},null,-1),u("Debug Data ")]))])]),v.value.length>0?(c(),i("div",Oe,[e("div",Ue,[e("div",$e,[t[21]||(t[21]=e("div",{class:"card-header bg-primary text-white"},[e("h5",{class:"mb-0"},[e("i",{class:"fas fa-truck me-2"}),u(" Th√¥ng tin giao h√†ng ")])],-1)),e("div",He,[e("form",{onSubmit:Pe(se,["prevent"])},[e("div",Ge,[e("div",Le,[t[14]||(t[14]=e("label",{for:"fullName",class:"form-label"},"H·ªç v√† t√™n *",-1)),I(e("input",{type:"text",class:M(["form-control",{"is-invalid":p.value.fullName}]),id:"fullName","onUpdate:modelValue":t[0]||(t[0]=o=>a.value.fullName=o),required:""},null,2),[[D,a.value.fullName]]),p.value.fullName?(c(),i("div",Fe,r(p.value.fullName),1)):f("",!0)]),e("div",je,[t[15]||(t[15]=e("label",{for:"phone",class:"form-label"},"S·ªë ƒëi·ªán tho·∫°i *",-1)),I(e("input",{type:"tel",class:M(["form-control",{"is-invalid":p.value.phone}]),id:"phone","onUpdate:modelValue":t[1]||(t[1]=o=>a.value.phone=o),required:""},null,2),[[D,a.value.phone]]),p.value.phone?(c(),i("div",Be,r(p.value.phone),1)):f("",!0)])]),e("div",Ke,[t[16]||(t[16]=e("label",{for:"email",class:"form-label"},"Email",-1)),I(e("input",{type:"email",class:M(["form-control",{"is-invalid":p.value.email}]),id:"email","onUpdate:modelValue":t[2]||(t[2]=o=>a.value.email=o)},null,2),[[D,a.value.email]]),p.value.email?(c(),i("div",qe,r(p.value.email),1)):f("",!0)]),e("div",Re,[t[17]||(t[17]=e("label",{for:"address",class:"form-label"},"ƒê·ªãa ch·ªâ giao h√†ng *",-1)),I(e("textarea",{class:M(["form-control",{"is-invalid":p.value.address}]),id:"address",rows:"3","onUpdate:modelValue":t[3]||(t[3]=o=>a.value.address=o),placeholder:"S·ªë nh√†, t√™n ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh ph·ªë",required:""},null,2),[[D,a.value.address]]),p.value.address?(c(),i("div",Je,r(p.value.address),1)):f("",!0)]),e("div",ze,[t[18]||(t[18]=e("label",{for:"notes",class:"form-label"},"Ghi ch√∫ ƒë∆°n h√†ng",-1)),I(e("textarea",{class:"form-control",id:"notes",rows:"2","onUpdate:modelValue":t[4]||(t[4]=o=>a.value.notes=o),placeholder:"Ghi ch√∫ v·ªÅ ƒë∆°n h√†ng, v√≠ d·ª•: th·ªùi gian hay ch·ªâ d·∫´n ƒë·ªãa ƒëi·ªÉm giao h√†ng chi ti·∫øt h∆°n."},null,512),[[D,a.value.notes]])]),P(x)?(c(),i("div",Ze,[e("div",We,[A(l,{to:"/profile",class:"btn btn-outline-info btn-sm",title:"Chuy·ªÉn ƒë·∫øn trang Profile ƒë·ªÉ c·∫≠p nh·∫≠t th√¥ng tin"},{default:E(()=>t[19]||(t[19]=[e("i",{class:"fas fa-user-edit me-2"},null,-1),u(" C·∫≠p nh·∫≠t th√¥ng tin t·ª´ Profile ")])),_:1,__:[19]})]),t[20]||(t[20]=e("div",{class:"mt-2"},[e("small",{class:"text-muted"},[e("i",{class:"fas fa-info-circle me-1"}),u(" Th√¥ng tin giao h√†ng s·∫Ω t·ª± ƒë·ªông ƒë∆∞·ª£c ƒë·ªìng b·ªô v·ªõi Profile khi ƒë·∫∑t h√†ng ")])],-1))])):f("",!0)],32)])]),e("div",Qe,[t[36]||(t[36]=e("div",{class:"card-header bg-success text-white"},[e("h5",{class:"mb-0"},[e("i",{class:"fas fa-money-bill-wave me-2"}),u(" Ph∆∞∆°ng th·ª©c thanh to√°n ")])],-1)),e("div",Ye,[F.value?(c(),i("div",Xe,t[22]||(t[22]=[e("div",{class:"spinner-border text-success",role:"status"},[e("span",{class:"visually-hidden"},"ƒêang t·∫£i...")],-1),e("p",{class:"mt-2 text-muted"},"ƒêang t·∫£i ph∆∞∆°ng th·ª©c thanh to√°n...",-1)]))):$.value.length>0?(c(),i("div",et,[(c(!0),i(R,null,J($.value,o=>(c(),i("div",{key:o.maPTTT,class:"col-md-6 mb-3"},[e("div",tt,[I(e("input",{class:"form-check-input",type:"radio",name:"paymentMethod",id:o.maPTTT,value:o.tenPTTT,"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.paymentMethod=s)},null,8,nt),[[ae,a.value.paymentMethod]]),e("label",{class:"form-check-label w-100",for:o.maPTTT},[e("div",st,[e("i",{class:M([ce(o.tenPTTT),"me-3 fs-4"])},null,2),e("div",null,[e("strong",null,r(o.tenPTTT),1),e("div",at,r(o.moTa),1),o.phiGiaoDich>0?(c(),i("div",lt," Ph√≠ giao d·ªãch: "+r(P(_)(o.phiGiaoDich)),1)):f("",!0)])])],8,ot)])]))),128))])):j.value?(c(),i("div",it,[t[24]||(t[24]=e("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),t[25]||(t[25]=u(" Kh√¥ng th·ªÉ t·∫£i ph∆∞∆°ng th·ª©c thanh to√°n. Vui l√≤ng th·ª≠ l·∫°i sau. ")),e("button",{onClick:te,class:"btn btn-sm btn-outline-warning ms-2"},t[23]||(t[23]=[e("i",{class:"fas fa-redo me-1"},null,-1),u("Th·ª≠ l·∫°i ")]))])):(c(),i("div",rt,[e("div",ct,[e("div",ut,[I(e("input",{class:"form-check-input",type:"radio",name:"paymentMethod",id:"cod",value:"cod","onUpdate:modelValue":t[6]||(t[6]=o=>a.value.paymentMethod=o)},null,512),[[ae,a.value.paymentMethod]]),t[26]||(t[26]=e("label",{class:"form-check-label w-100",for:"cod"},[e("div",{class:"d-flex align-items-center"},[e("i",{class:"fas fa-hand-holding-usd text-success me-3 fs-4"}),e("div",null,[e("strong",null,"Thanh to√°n khi nh·∫≠n h√†ng (COD)"),e("div",{class:"text-muted small"},"Thanh to√°n b·∫±ng ti·ªÅn m·∫∑t khi nh·∫≠n h√†ng")])])],-1))])])])),a.value.paymentMethod&&k.value?(c(),i("div",dt,[e("h6",ht,[t[27]||(t[27]=e("i",{class:"fas fa-info-circle me-2"},null,-1)),u(" Th√¥ng tin "+r(k.value.tenPTTT),1)]),e("div",mt,[e("div",gt,[e("p",pt,[t[28]||(t[28]=e("strong",null,"S·ªë ti·ªÅn:",-1)),u(" "+r(P(_)(V.value)),1)]),e("p",ft,[t[29]||(t[29]=e("strong",null,"M√£ ƒë∆°n h√†ng:",-1)),u(" "+r(y.value),1)]),k.value.phiGiaoDich>0?(c(),i("p",vt,[t[30]||(t[30]=e("strong",null,"Ph√≠ giao d·ªãch:",-1)),u(" "+r(P(_)(k.value.phiGiaoDich)),1)])):f("",!0)]),e("div",yt,[e("p",bt,[e("small",null,[t[31]||(t[31]=e("strong",null,"H∆∞·ªõng d·∫´n:",-1)),u(" "+r(ue(k.value.tenPTTT)),1)])])])]),k.value.tenPTTT==="Chuy·ªÉn Kho·∫£n"?(c(),i("div",kt,[t[35]||(t[35]=e("h6",{class:"text-primary mb-2"},"Th√¥ng tin chuy·ªÉn kho·∫£n",-1)),e("div",_t,[t[34]||(t[34]=e("div",{class:"col-md-6"},[e("p",{class:"mb-1"},[e("strong",null,"Ng√¢n h√†ng:"),u(" Vietcombank")]),e("p",{class:"mb-1"},[e("strong",null,"S·ªë t√†i kho·∫£n:"),u(" 1234567890")]),e("p",{class:"mb-1"},[e("strong",null,"Ch·ªß t√†i kho·∫£n:"),u(" EASYMART COMPANY")])],-1)),e("div",Tt,[e("p",Pt,[t[32]||(t[32]=e("strong",null,"N·ªôi dung:",-1)),u(" THANHTOAN "+r(y.value),1)]),t[33]||(t[33]=e("p",{class:"mb-0 text-danger"},[e("small",null,[e("strong",null,"L∆∞u √Ω:"),u(" Vui l√≤ng chuy·ªÉn kho·∫£n ƒë√∫ng n·ªôi dung ƒë·ªÉ ƒë∆°n h√†ng ƒë∆∞·ª£c x·ª≠ l√Ω nhanh ch√≥ng.")])],-1))])])])):f("",!0)])):f("",!0)])])]),e("div",xt,[e("div",It,[t[45]||(t[45]=e("div",{class:"card-header bg-warning text-dark"},[e("h5",{class:"mb-0"},[e("i",{class:"fas fa-receipt me-2"}),u(" ƒê∆°n h√†ng c·ªßa b·∫°n ")])],-1)),e("div",wt,[e("div",St,[(c(!0),i(R,null,J(v.value,o=>(c(),i("div",{key:o.productId,class:"order-item d-flex align-items-center mb-3 pb-3 border-bottom"},[e("img",{src:o.product?.image,alt:o.product?.name,class:"order-item-image me-3"},null,8,Ct),e("div",Mt,[e("h6",Nt,r(o.product?.name),1),e("div",Dt,[e("span",Vt,r(P(_)(o.product?.price||0))+" x "+r(o.quantity),1),e("span",At,r(P(_)((o.product?.price||0)*o.quantity)),1)])])]))),128))]),e("div",Et,[e("div",Ot,[e("span",null,"T·∫°m t√≠nh ("+r(K.value)+" s·∫£n ph·∫©m):",1),e("span",null,r(P(_)(N.value)),1)]),k.value&&k.value.phiGiaoDich>0?(c(),i("div",Ut,[e("span",null,"Ph√≠ giao d·ªãch ("+r(k.value.tenPTTT)+"):",1),e("span",$t,r(P(_)(k.value.phiGiaoDich)),1)])):f("",!0),e("div",Ht,[e("div",Gt,[I(e("input",{type:"text",class:"form-control form-control-sm",placeholder:"Nh·∫≠p m√£ khuy·∫øn m√£i","onUpdate:modelValue":t[7]||(t[7]=o=>w.value=o),disabled:g.value},null,8,Lt),[[D,w.value]]),e("button",{class:"btn btn-outline-primary btn-sm",onClick:oe,disabled:!w.value.trim()||g.value||H.value},[H.value?(c(),i("span",jt,t[37]||(t[37]=[e("i",{class:"fas fa-spinner fa-spin"},null,-1)]))):(c(),i("span",Bt,r(g.value?"ƒê√£ √°p d·ª•ng":"√Åp d·ª•ng"),1))],8,Ft)]),g.value?(c(),i("div",Kt,[e("div",qt,[e("div",null,[e("small",Rt,[t[38]||(t[38]=e("i",{class:"fas fa-ticket-alt me-1"},null,-1)),u(" "+r(g.value.code),1)]),e("div",Jt,r(g.value.description),1)]),e("button",{class:"btn btn-sm",style:{background:"linear-gradient(135deg, #ff6b6b, #ee5a5a)",color:"white",border:"none"},onClick:ge,title:"X√≥a m√£ khuy·∫øn m√£i"},t[39]||(t[39]=[e("i",{class:"fas fa-times"},null,-1)]))])])):f("",!0),S.value>0?(c(),i("div",zt,[e("span",null,"Gi·∫£m gi√° ("+r(g.value?.code)+"):",1),e("span",null,"-"+r(P(_)(S.value)),1)])):f("",!0),!g.value&&B.value.length>0?(c(),i("div",Zt,[t[40]||(t[40]=e("small",{class:"text-muted d-block mb-2"},"M√£ khuy·∫øn m√£i c√≥ s·∫µn:",-1)),e("div",Wt,[(c(!0),i(R,null,J(B.value,o=>(c(),i("button",{key:o.code,class:"btn btn-sm",style:{background:"linear-gradient(135deg, #667eea, #764ba2)",color:"white",border:"none"},onClick:s=>pe(o.code),title:o.description},r(o.code),9,Qt))),128))])])):f("",!0)]),t[44]||(t[44]=e("hr",null,null,-1)),e("div",Yt,[t[41]||(t[41]=e("strong",{class:"fs-5"},"T·ªïng c·ªông:",-1)),e("strong",Xt,r(P(_)(V.value)),1)]),e("button",{type:"button",class:"btn btn-primary w-100 mb-2 py-2",onClick:se,disabled:U.value||!de.value},[U.value?(c(),i("span",tn,t[42]||(t[42]=[e("i",{class:"fas fa-spinner fa-spin me-2"},null,-1),u(" ƒêang x·ª≠ l√Ω... ")]))):(c(),i("span",nn,t[43]||(t[43]=[e("i",{class:"fas fa-check me-2"},null,-1),u(" ƒê·∫∑t h√†ng ")])))],8,en),A(l,{to:T.value?"/":"/cart",class:"btn btn-outline-secondary w-100"},{default:E(()=>[e("i",{class:M([T.value?"fas fa-home":"fas fa-arrow-left","me-2"])},null,2),u(" "+r(T.value?"V·ªÅ trang ch·ªß":"Quay l·∫°i gi·ªè h√†ng"),1)]),_:1},8,["to"])])])])])])):(c(),i("div",on,[e("div",sn,[e("div",an,[t[46]||(t[46]=e("div",{class:"empty-checkout-icon mb-4"},[e("i",{class:"fas fa-exclamation-triangle fa-5x text-warning"})],-1)),t[47]||(t[47]=e("h3",{class:"text-muted mb-3"},"Kh√¥ng c√≥ s·∫£n ph·∫©m ƒë·ªÉ thanh to√°n",-1)),e("p",ln,r(T.value?"Vui l√≤ng quay l·∫°i trang s·∫£n ph·∫©m ƒë·ªÉ mua h√†ng":"Vui l√≤ng quay l·∫°i gi·ªè h√†ng v√† ch·ªçn s·∫£n ph·∫©m ƒë·ªÉ thanh to√°n"),1),A(l,{to:T.value?"/":"/cart",class:"btn btn-primary btn-lg"},{default:E(()=>[e("i",{class:M([T.value?"fas fa-home":"fas fa-arrow-left","me-2"])},null,2),u(" "+r(T.value?"V·ªÅ trang ch·ªß":"Quay l·∫°i gi·ªè h√†ng"),1)]),_:1},8,["to"])])])]))])])}}},dn=ve(rn,[["__scopeId","data-v-42a4afba"]]);export{dn as default};

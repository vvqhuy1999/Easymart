import{_ as S,d as l,e as a,f as t,t as v,g as w,w as G,i as n,p as T,H as V,r,o as L,l as p,n as b,j as N,k as _,v as B,I as P,J as q,h as D,b as E,K as U}from"./index-BeyCD7yF.js";const j={class:"google-signin-wrapper"},R={class:"text-center my-3"},z={class:"position-relative"},A={class:"position-absolute top-50 start-50 translate-middle bg-white px-3 text-muted"},H={class:"d-grid"},J=["disabled"],K={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"},W={key:1,class:"fab fa-google me-2"},F={__name:"GoogleSignIn",props:{buttonText:{type:String,default:"Đăng nhập với Google"},dividerText:{type:String,default:"hoặc"},loading:{type:Boolean,default:!1}},emits:["google-login"],setup(u,{emit:f}){const y=f,x=d=>{y("google-login",d)};return(d,c)=>(a(),l("div",j,[t("div",R,[t("div",z,[c[0]||(c[0]=t("hr",{class:"my-3"},null,-1)),t("span",A,v(u.dividerText),1)])]),t("div",H,[w(T(V),{callback:x,prompt:"","auto-login":"",class:"google-signin-btn"},{default:G(()=>[t("button",{type:"button",class:"btn btn-outline-danger w-100 fw-bold",disabled:u.loading},[u.loading?(a(),l("span",K)):(a(),l("i",W)),n(" "+v(u.loading?"Đang xử lý...":u.buttonText),1)],8,J)]),_:1})])]))}},O=S(F,[["__scopeId","data-v-1c1e3ec2"]]),Q={class:"d-flex justify-content-center align-items-center",style:{"min-height":"80vh",background:"#f8fafc"}},X={class:"card shadow p-4 border-0",style:{"max-width":"400px",width:"100%","border-radius":"1.5rem"}},Y={key:0,class:"text-center mb-3"},Z={key:1,class:"alert alert-info",role:"alert"},ee={key:2,class:"alert alert-danger",role:"alert"},te={key:3,class:"alert alert-success",role:"alert"},se={class:"mb-3"},le={class:"input-group"},ae={class:"mb-3"},oe={class:"input-group"},ne=["type"],ie={class:"mb-3 form-check"},re=["disabled"],ue={key:0,class:"fas fa-sign-in-alt me-2"},de={key:1,class:"spinner-border spinner-border-sm me-2",role:"status"},ce={__name:"Login",setup(u){const f=E(),{login:y,loginWithGoogle:x}=U(),d=r(""),c=r(""),C=r(!1),h=r(!1),s=r(!1),i=r(""),m=r(""),$=r(!1);L(()=>{const o=localStorage.getItem("easymart-redirect-after-login");$.value=o==="/checkout"});async function I(){i.value="",m.value="",s.value=!0;try{const o=await y(d.value,c.value);if(o.success){m.value=`Chào mừng ${o.user.name}! Đang chuyển hướng...`;const e=localStorage.getItem("easymart-redirect-after-login");localStorage.removeItem("easymart-redirect-after-login"),setTimeout(()=>{f.push(e||"/")},1500)}else i.value=o.error||"Đăng nhập thất bại"}catch{i.value="Có lỗi xảy ra, vui lòng thử lại"}finally{s.value=!1}}async function M(o){i.value="",m.value="",s.value=!0;try{const e=await x(o.credential);if(e.success){m.value=`Chào mừng ${e.user.name}! Đang chuyển hướng...`;const k=localStorage.getItem("easymart-redirect-after-login");localStorage.removeItem("easymart-redirect-after-login"),setTimeout(()=>{f.push(k||"/")},1500)}else i.value=e.error||"Đăng nhập với Google thất bại"}catch{i.value="Có lỗi xảy ra khi đăng nhập với Google, vui lòng thử lại"}finally{s.value=!1}}return(o,e)=>{const k=D("router-link");return a(),l("div",null,[t("div",Q,[t("div",X,[e[16]||(e[16]=t("h2",{class:"mb-4 text-center text-primary fw-bold"},"Đăng nhập",-1)),s.value?(a(),l("div",Y,e[4]||(e[4]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Đang đăng nhập...")],-1),t("p",{class:"mt-2 text-muted"},"Đang xử lý...",-1)]))):p("",!0),$.value?(a(),l("div",Z,e[5]||(e[5]=[t("i",{class:"fas fa-info-circle me-2"},null,-1),n(" Vui lòng đăng nhập để tiến hành thanh toán! ")]))):p("",!0),i.value?(a(),l("div",ee,[e[6]||(e[6]=t("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),n(v(i.value),1)])):p("",!0),m.value?(a(),l("div",te,[e[7]||(e[7]=t("i",{class:"fas fa-check-circle me-2"},null,-1)),n(v(m.value),1)])):p("",!0),t("form",{onSubmit:N(I,["prevent"]),class:b({"d-none":s.value})},[t("div",se,[e[9]||(e[9]=t("label",{for:"email",class:"form-label"},"Email",-1)),t("div",le,[e[8]||(e[8]=t("span",{class:"input-group-text"},[t("i",{class:"fas fa-envelope"})],-1)),_(t("input",{"onUpdate:modelValue":e[0]||(e[0]=g=>d.value=g),type:"email",class:"form-control",id:"email",required:"",autocomplete:"username",placeholder:"Nhập email của bạn"},null,512),[[B,d.value]])])]),t("div",ae,[e[11]||(e[11]=t("label",{for:"password",class:"form-label"},"Mật khẩu",-1)),t("div",oe,[e[10]||(e[10]=t("span",{class:"input-group-text"},[t("i",{class:"fas fa-lock"})],-1)),_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=g=>c.value=g),type:h.value?"text":"password",class:"form-control",id:"password",required:"",autocomplete:"current-password",placeholder:"Nhập mật khẩu"},null,8,ne),[[P,c.value]]),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:e[2]||(e[2]=g=>h.value=!h.value)},[t("i",{class:b(h.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])]),t("div",ie,[_(t("input",{type:"checkbox",class:"form-check-input",id:"rememberMe","onUpdate:modelValue":e[3]||(e[3]=g=>C.value=g)},null,512),[[q,C.value]]),e[12]||(e[12]=t("label",{class:"form-check-label",for:"rememberMe"}," Ghi nhớ đăng nhập ",-1))]),t("button",{type:"submit",class:"btn btn-primary w-100 fw-bold",disabled:s.value},[s.value?p("",!0):(a(),l("i",ue)),s.value?(a(),l("span",de)):p("",!0),n(" "+v(s.value?"Đang đăng nhập...":"Đăng nhập"),1)],8,re)],34),w(O,{loading:s.value,onGoogleLogin:M},null,8,["loading"]),t("div",{class:b(["text-center mt-3",{"d-none":s.value}])},[e[14]||(e[14]=t("span",null,"Bạn chưa có tài khoản?",-1)),w(k,{to:"/register",class:"ms-1 text-primary"},{default:G(()=>e[13]||(e[13]=[n("Đăng ký")])),_:1,__:[13]})],2),t("div",{class:b(["mt-4 p-3 bg-light rounded",{"d-none":s.value}])},e[15]||(e[15]=[t("h6",{class:"text-muted mb-2"},[t("i",{class:"fas fa-info-circle me-2"}),n("Tài khoản demo:")],-1),t("small",{class:"text-muted"},[n(" Email: demo@easymart.vn"),t("br"),n(" Mật khẩu: bất kỳ ")],-1)]),2)])])])}}},ge=S(ce,[["__scopeId","data-v-53a92acb"]]);export{ge as default};

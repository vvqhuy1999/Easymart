import{_ as H,u as A,r as x,c as _,o as E,a as F,b as j,d as i,e as s,f as S,w as q,g as z,h as l,i as Z,j as h,k as v,v as M,n as w,t as a,l as k,m as g,F as D,p as J,q as d}from"./index-BIETZaLS.js";const G={class:"checkout-page"},L={class:"container py-5 mt-5"},Y={"aria-label":"breadcrumb",class:"mb-4"},K={class:"breadcrumb"},X={class:"breadcrumb-item"},W={class:"breadcrumb-item"},ss={key:0,class:"row"},ts={class:"col-lg-8"},es={class:"card mb-4"},ns={class:"card-body"},ls={class:"row"},as={class:"col-md-6 mb-3"},os={key:0,class:"invalid-feedback"},is={class:"col-md-6 mb-3"},ds={key:0,class:"invalid-feedback"},rs={class:"mb-3"},us={key:0,class:"invalid-feedback"},ms={class:"mb-3"},cs={key:0,class:"invalid-feedback"},hs={class:"mb-3"},vs={class:"card mb-4"},ps={class:"card-body"},gs={class:"row"},fs={class:"col-md-6 mb-3"},ys={class:"form-check payment-method"},bs={class:"col-md-6 mb-3"},ks={class:"form-check payment-method"},xs={class:"col-md-6 mb-3"},_s={class:"form-check payment-method"},Ms={class:"col-md-6 mb-3"},ws={class:"form-check payment-method"},Vs={class:"col-md-6 mb-3"},Ns={class:"form-check payment-method"},Ts={class:"col-md-6 mb-3"},Ss={class:"form-check payment-method"},qs={key:0,class:"banking-info mt-3 p-3 bg-light rounded"},Cs={class:"row"},Ps={class:"col-md-6"},Is={class:"mb-2"},Os={key:1,class:"payment-info mt-3 p-3 bg-light rounded"},Qs={class:"row align-items-center"},Us={class:"col-md-6"},$s={class:"mb-2"},Rs={class:"mb-2"},Bs={key:2,class:"payment-info mt-3 p-3 bg-light rounded"},Hs={class:"row"},As={class:"col-md-6"},Es={class:"mb-2"},Fs={class:"mb-2"},js={key:3,class:"payment-info mt-3 p-3 bg-light rounded"},zs={class:"row"},Zs={class:"col-md-6"},Ds={class:"mb-2"},Js={class:"mb-2"},Gs={key:4,class:"payment-info mt-3 p-3 bg-light rounded"},Ls={class:"row"},Ys={class:"col-md-6"},Ks={class:"mb-2"},Xs={class:"mb-2"},Ws={class:"col-lg-4"},st={class:"card sticky-top",style:{top:"100px"}},tt={class:"card-body"},et={class:"order-items mb-3"},nt=["src","alt"],lt={class:"flex-grow-1"},at={class:"mb-1"},ot={class:"d-flex justify-content-between"},it={class:"text-muted"},dt={class:"fw-bold"},rt={class:"order-summary"},ut={class:"d-flex justify-content-between mb-2"},mt={class:"d-flex justify-content-between mb-2"},ct={key:0,class:"small text-success mb-2"},ht={class:"d-flex justify-content-between mb-3"},vt={class:"text-danger fs-5"},pt=["disabled"],gt={key:0},ft={key:1},yt={key:1,class:"row"},bt={class:"col-12"},kt={class:"empty-checkout text-center py-5"},xt={__name:"Checkout",setup(_t){const P=j(),{formatPrice:p,showNotification:c,products:Q}=A(),{cart:V}=F(),N=x(!1),r=x(""),o=x({}),e=x({fullName:"",phone:"",email:"",address:"",notes:"",paymentMethod:"cod"}),f=x([]),T=_(()=>f.value.reduce((u,t)=>u+(t.product?.price||0)*t.quantity,0)),b=_(()=>T.value>=2e5?0:3e4),y=_(()=>T.value+b.value),I=_(()=>f.value.reduce((u,t)=>u+t.quantity,0)),U=_(()=>e.value.fullName&&e.value.phone&&e.value.address&&e.value.paymentMethod),$=()=>{const u=Date.now().toString().slice(-6),t=Math.random().toString(36).substr(2,4).toUpperCase();return`EM${u}${t}`},R=()=>(o.value={},e.value.fullName.trim()||(o.value.fullName="Vui lòng nhập họ và tên"),e.value.phone.trim()?/^[0-9]{10,11}$/.test(e.value.phone.replace(/\s/g,""))||(o.value.phone="Số điện thoại không hợp lệ"):o.value.phone="Vui lòng nhập số điện thoại",e.value.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.value.email)&&(o.value.email="Email không hợp lệ"),e.value.address.trim()||(o.value.address="Vui lòng nhập địa chỉ giao hàng"),Object.keys(o.value).length===0),O=async()=>{if(!R()){c("Vui lòng kiểm tra lại thông tin đơn hàng","error");return}N.value=!0;try{await new Promise(m=>setTimeout(m,2e3));const u={orderCode:r.value,customer:{...e.value},items:f.value,summary:{subtotal:T.value,shippingFee:b.value,total:y.value,itemsCount:I.value},createdAt:new Date().toISOString()},t=JSON.parse(localStorage.getItem("easymart-orders")||"[]");t.push(u),localStorage.setItem("easymart-orders",JSON.stringify(t)),f.value.forEach(m=>{const n=V.value.findIndex(C=>C.productId===m.productId);n!==-1&&V.value.splice(n,1)}),localStorage.setItem("easymart-cart",JSON.stringify(V.value)),localStorage.removeItem("easymart-selected-items"),B(u)}catch{c("Có lỗi xảy ra khi đặt hàng. Vui lòng thử lại!","error")}finally{N.value=!1}},B=u=>{const t=e.value.paymentMethod;switch(localStorage.setItem("easymart-last-order",JSON.stringify(u)),t){case"cod":c(`Đặt hàng thành công! Mã đơn hàng: ${r.value}. Bạn sẽ thanh toán khi nhận hàng.`,"success");break;case"banking":c(`Đặt hàng thành công! Mã đơn hàng: ${r.value}. Vui lòng chuyển khoản theo thông tin đã cung cấp.`,"success");break;case"qr":c(`Đặt hàng thành công! Mã đơn hàng: ${r.value}. Vui lòng quét mã QR để thanh toán.`,"success");break;case"momo":c("Đang chuyển đến MoMo để thanh toán...","info"),setTimeout(()=>{c(`Thanh toán MoMo thành công! Mã đơn hàng: ${r.value}`,"success")},1500);break;case"vnpay":c("Đang chuyển đến VNPay để thanh toán...","info"),setTimeout(()=>{c(`Thanh toán VNPay thành công! Mã đơn hàng: ${r.value}`,"success")},1500);break;case"zalopay":c("Đang chuyển đến ZaloPay để thanh toán...","info"),setTimeout(()=>{c(`Thanh toán ZaloPay thành công! Mã đơn hàng: ${r.value}`,"success")},1500);break;default:c(`Đặt hàng thành công! Mã đơn hàng: ${r.value}`,"success")}setTimeout(()=>{P.push({name:"PaymentSuccess",query:{orderCode:r.value,total:y.value,paymentMethod:t}})},3e3)};return E(()=>{r.value=$();const u=localStorage.getItem("easymart-selected-items");if(u){const t=JSON.parse(u);f.value=V.value.filter(m=>t.includes(m.productId)).map(m=>{const n=Q.value.find(C=>C.id===m.productId);return{...m,product:n}}).filter(m=>m.product)}f.value.length===0&&(c("Vui lòng chọn sản phẩm từ giỏ hàng để thanh toán","warning"),P.push("/cart"))}),(u,t)=>{const m=z("router-link");return d(),i("div",G,[s("div",L,[s("nav",Y,[s("ol",K,[s("li",X,[S(m,{to:"/",class:"text-decoration-none"},{default:q(()=>t[11]||(t[11]=[s("i",{class:"fas fa-home"},null,-1),l(" Trang chủ ")])),_:1,__:[11]})]),s("li",W,[S(m,{to:"/cart",class:"text-decoration-none"},{default:q(()=>t[12]||(t[12]=[s("i",{class:"fas fa-shopping-cart"},null,-1),l(" Giỏ hàng ")])),_:1,__:[12]})]),t[13]||(t[13]=s("li",{class:"breadcrumb-item active","aria-current":"page"},[s("i",{class:"fas fa-credit-card"}),l(" Thanh toán ")],-1))])]),t[60]||(t[60]=s("h2",{class:"mb-4"},[s("i",{class:"fas fa-credit-card text-primary me-2"}),l(" Thanh toán đơn hàng ")],-1)),f.value.length>0?(d(),i("div",ss,[s("div",ts,[s("div",es,[t[19]||(t[19]=s("div",{class:"card-header bg-primary text-white"},[s("h5",{class:"mb-0"},[s("i",{class:"fas fa-truck me-2"}),l(" Thông tin giao hàng ")])],-1)),s("div",ns,[s("form",{onSubmit:Z(O,["prevent"])},[s("div",ls,[s("div",as,[t[14]||(t[14]=s("label",{for:"fullName",class:"form-label"},"Họ và tên *",-1)),h(s("input",{type:"text",class:w(["form-control",{"is-invalid":o.value.fullName}]),id:"fullName","onUpdate:modelValue":t[0]||(t[0]=n=>e.value.fullName=n),required:""},null,2),[[M,e.value.fullName]]),o.value.fullName?(d(),i("div",os,a(o.value.fullName),1)):v("",!0)]),s("div",is,[t[15]||(t[15]=s("label",{for:"phone",class:"form-label"},"Số điện thoại *",-1)),h(s("input",{type:"tel",class:w(["form-control",{"is-invalid":o.value.phone}]),id:"phone","onUpdate:modelValue":t[1]||(t[1]=n=>e.value.phone=n),required:""},null,2),[[M,e.value.phone]]),o.value.phone?(d(),i("div",ds,a(o.value.phone),1)):v("",!0)])]),s("div",rs,[t[16]||(t[16]=s("label",{for:"email",class:"form-label"},"Email",-1)),h(s("input",{type:"email",class:w(["form-control",{"is-invalid":o.value.email}]),id:"email","onUpdate:modelValue":t[2]||(t[2]=n=>e.value.email=n)},null,2),[[M,e.value.email]]),o.value.email?(d(),i("div",us,a(o.value.email),1)):v("",!0)]),s("div",ms,[t[17]||(t[17]=s("label",{for:"address",class:"form-label"},"Địa chỉ giao hàng *",-1)),h(s("textarea",{class:w(["form-control",{"is-invalid":o.value.address}]),id:"address",rows:"3","onUpdate:modelValue":t[3]||(t[3]=n=>e.value.address=n),placeholder:"Số nhà, tên đường, phường/xã, quận/huyện, tỉnh/thành phố",required:""},null,2),[[M,e.value.address]]),o.value.address?(d(),i("div",cs,a(o.value.address),1)):v("",!0)]),s("div",hs,[t[18]||(t[18]=s("label",{for:"notes",class:"form-label"},"Ghi chú đơn hàng",-1)),h(s("textarea",{class:"form-control",id:"notes",rows:"2","onUpdate:modelValue":t[4]||(t[4]=n=>e.value.notes=n),placeholder:"Ghi chú về đơn hàng, ví dụ: thời gian hay chỉ dẫn địa điểm giao hàng chi tiết hơn."},null,512),[[M,e.value.notes]])])],32)])]),s("div",vs,[t[47]||(t[47]=s("div",{class:"card-header bg-success text-white"},[s("h5",{class:"mb-0"},[s("i",{class:"fas fa-money-bill-wave me-2"}),l(" Phương thức thanh toán ")])],-1)),s("div",ps,[s("div",gs,[s("div",fs,[s("div",ys,[h(s("input",{class:"form-check-input",type:"radio",name:"paymentMethod",id:"cod",value:"cod","onUpdate:modelValue":t[5]||(t[5]=n=>e.value.paymentMethod=n)},null,512),[[k,e.value.paymentMethod]]),t[20]||(t[20]=s("label",{class:"form-check-label w-100",for:"cod"},[s("div",{class:"d-flex align-items-center"},[s("i",{class:"fas fa-hand-holding-usd text-success me-3 fs-4"}),s("div",null,[s("strong",null,"Thanh toán khi nhận hàng (COD)"),s("div",{class:"text-muted small"},"Thanh toán bằng tiền mặt khi nhận hàng")])])],-1))])]),s("div",bs,[s("div",ks,[h(s("input",{class:"form-check-input",type:"radio",name:"paymentMethod",id:"banking",value:"banking","onUpdate:modelValue":t[6]||(t[6]=n=>e.value.paymentMethod=n)},null,512),[[k,e.value.paymentMethod]]),t[21]||(t[21]=s("label",{class:"form-check-label w-100",for:"banking"},[s("div",{class:"d-flex align-items-center"},[s("i",{class:"fas fa-university text-primary me-3 fs-4"}),s("div",null,[s("strong",null,"Chuyển khoản ngân hàng"),s("div",{class:"text-muted small"},"Chuyển khoản trước khi giao hàng")])])],-1))])]),s("div",xs,[s("div",_s,[h(s("input",{class:"form-check-input",type:"radio",name:"paymentMethod",id:"qr",value:"qr","onUpdate:modelValue":t[7]||(t[7]=n=>e.value.paymentMethod=n)},null,512),[[k,e.value.paymentMethod]]),t[22]||(t[22]=s("label",{class:"form-check-label w-100",for:"qr"},[s("div",{class:"d-flex align-items-center"},[s("i",{class:"fas fa-qrcode text-dark me-3 fs-4"}),s("div",null,[s("strong",null,"Quét mã QR"),s("div",{class:"text-muted small"},"Quét QR để thanh toán nhanh")])])],-1))])]),s("div",Ms,[s("div",ws,[h(s("input",{class:"form-check-input",type:"radio",name:"paymentMethod",id:"momo",value:"momo","onUpdate:modelValue":t[8]||(t[8]=n=>e.value.paymentMethod=n)},null,512),[[k,e.value.paymentMethod]]),t[23]||(t[23]=s("label",{class:"form-check-label w-100",for:"momo"},[s("div",{class:"d-flex align-items-center"},[s("i",{class:"fab fa-momo text-danger me-3 fs-4"}),s("div",null,[s("strong",null,"Ví MoMo"),s("div",{class:"text-muted small"},"Thanh toán qua ví điện tử MoMo")])])],-1))])]),s("div",Vs,[s("div",Ns,[h(s("input",{class:"form-check-input",type:"radio",name:"paymentMethod",id:"vnpay",value:"vnpay","onUpdate:modelValue":t[9]||(t[9]=n=>e.value.paymentMethod=n)},null,512),[[k,e.value.paymentMethod]]),t[24]||(t[24]=s("label",{class:"form-check-label w-100",for:"vnpay"},[s("div",{class:"d-flex align-items-center"},[s("i",{class:"fas fa-credit-card text-info me-3 fs-4"}),s("div",null,[s("strong",null,"VNPay"),s("div",{class:"text-muted small"},"Thanh toán qua cổng VNPay")])])],-1))])]),s("div",Ts,[s("div",Ss,[h(s("input",{class:"form-check-input",type:"radio",name:"paymentMethod",id:"zalopay",value:"zalopay","onUpdate:modelValue":t[10]||(t[10]=n=>e.value.paymentMethod=n)},null,512),[[k,e.value.paymentMethod]]),t[25]||(t[25]=s("label",{class:"form-check-label w-100",for:"zalopay"},[s("div",{class:"d-flex align-items-center"},[s("i",{class:"fas fa-mobile-alt text-warning me-3 fs-4"}),s("div",null,[s("strong",null,"ZaloPay"),s("div",{class:"text-muted small"},"Thanh toán qua ví ZaloPay")])])],-1))])])]),e.value.paymentMethod==="banking"?(d(),i("div",qs,[t[29]||(t[29]=s("h6",{class:"text-primary mb-3"},[s("i",{class:"fas fa-info-circle me-2"}),l(" Thông tin chuyển khoản ")],-1)),s("div",Cs,[t[28]||(t[28]=s("div",{class:"col-md-6"},[s("p",{class:"mb-2"},[s("strong",null,"Ngân hàng:"),l(" Vietcombank")]),s("p",{class:"mb-2"},[s("strong",null,"Số tài khoản:"),l(" 1234567890")]),s("p",{class:"mb-2"},[s("strong",null,"Chủ tài khoản:"),l(" EASYMART COMPANY")])],-1)),s("div",Ps,[s("p",Is,[t[26]||(t[26]=s("strong",null,"Nội dung:",-1)),l(" THANHTOAN "+a(r.value),1)]),t[27]||(t[27]=s("p",{class:"mb-0 text-danger"},[s("small",null,[s("strong",null,"Lưu ý:"),l(" Vui lòng chuyển khoản đúng nội dung để đơn hàng được xử lý nhanh chóng.")])],-1))])])])):v("",!0),e.value.paymentMethod==="qr"?(d(),i("div",Os,[t[34]||(t[34]=s("h6",{class:"text-dark mb-3"},[s("i",{class:"fas fa-qrcode me-2"}),l(" Quét mã QR để thanh toán ")],-1)),s("div",Qs,[t[33]||(t[33]=s("div",{class:"col-md-6 text-center"},[s("div",{class:"qr-code-placeholder"},[s("i",{class:"fas fa-qrcode fa-5x text-muted mb-2"}),s("p",{class:"text-muted"},"Mã QR sẽ được tạo sau khi đặt hàng")])],-1)),s("div",Us,[s("p",$s,[t[30]||(t[30]=s("strong",null,"Số tiền:",-1)),l(" "+a(g(p)(y.value)),1)]),s("p",Rs,[t[31]||(t[31]=s("strong",null,"Mã đơn hàng:",-1)),l(" "+a(r.value),1)]),t[32]||(t[32]=s("p",{class:"mb-0 text-info"},[s("small",null,[s("strong",null,"Hướng dẫn:"),l(" Mở app ngân hàng → Quét QR → Xác nhận thanh toán")])],-1))])])])):v("",!0),e.value.paymentMethod==="momo"?(d(),i("div",Bs,[t[38]||(t[38]=s("h6",{class:"text-danger mb-3"},[s("i",{class:"fab fa-momo me-2"}),l(" Thanh toán qua ví MoMo ")],-1)),s("div",Hs,[s("div",As,[s("p",Es,[t[35]||(t[35]=s("strong",null,"Số tiền:",-1)),l(" "+a(g(p)(y.value)),1)]),s("p",Fs,[t[36]||(t[36]=s("strong",null,"Mã đơn hàng:",-1)),l(" "+a(r.value),1)])]),t[37]||(t[37]=s("div",{class:"col-md-6"},[s("p",{class:"mb-0 text-info"},[s("small",null,[s("strong",null,"Hướng dẫn:"),l(" Bạn sẽ được chuyển đến app MoMo để hoàn tất thanh toán sau khi đặt hàng.")])])],-1))])])):v("",!0),e.value.paymentMethod==="vnpay"?(d(),i("div",js,[t[42]||(t[42]=s("h6",{class:"text-info mb-3"},[s("i",{class:"fas fa-credit-card me-2"}),l(" Thanh toán qua VNPay ")],-1)),s("div",zs,[s("div",Zs,[s("p",Ds,[t[39]||(t[39]=s("strong",null,"Số tiền:",-1)),l(" "+a(g(p)(y.value)),1)]),s("p",Js,[t[40]||(t[40]=s("strong",null,"Mã đơn hàng:",-1)),l(" "+a(r.value),1)])]),t[41]||(t[41]=s("div",{class:"col-md-6"},[s("p",{class:"mb-2"},[s("strong",null,"Hỗ trợ:"),l(" Thẻ ATM, Internet Banking, Ví điện tử")]),s("p",{class:"mb-0 text-info"},[s("small",null,[s("strong",null,"Hướng dẫn:"),l(" Bạn sẽ được chuyển đến cổng thanh toán VNPay để hoàn tất giao dịch.")])])],-1))])])):v("",!0),e.value.paymentMethod==="zalopay"?(d(),i("div",Gs,[t[46]||(t[46]=s("h6",{class:"text-warning mb-3"},[s("i",{class:"fas fa-mobile-alt me-2"}),l(" Thanh toán qua ZaloPay ")],-1)),s("div",Ls,[s("div",Ys,[s("p",Ks,[t[43]||(t[43]=s("strong",null,"Số tiền:",-1)),l(" "+a(g(p)(y.value)),1)]),s("p",Xs,[t[44]||(t[44]=s("strong",null,"Mã đơn hàng:",-1)),l(" "+a(r.value),1)])]),t[45]||(t[45]=s("div",{class:"col-md-6"},[s("p",{class:"mb-0 text-info"},[s("small",null,[s("strong",null,"Hướng dẫn:"),l(" Bạn sẽ được chuyển đến app ZaloPay để hoàn tất thanh toán sau khi đặt hàng.")])])],-1))])])):v("",!0)])])]),s("div",Ws,[s("div",st,[t[55]||(t[55]=s("div",{class:"card-header bg-warning text-dark"},[s("h5",{class:"mb-0"},[s("i",{class:"fas fa-receipt me-2"}),l(" Đơn hàng của bạn ")])],-1)),s("div",tt,[s("div",et,[(d(!0),i(D,null,J(f.value,n=>(d(),i("div",{key:n.productId,class:"order-item d-flex align-items-center mb-3 pb-3 border-bottom"},[s("img",{src:n.product?.image,alt:n.product?.name,class:"order-item-image me-3"},null,8,nt),s("div",lt,[s("h6",at,a(n.product?.name),1),s("div",ot,[s("span",it,a(g(p)(n.product?.price||0))+" x "+a(n.quantity),1),s("span",dt,a(g(p)((n.product?.price||0)*n.quantity)),1)])])]))),128))]),s("div",rt,[s("div",ut,[s("span",null,"Tạm tính ("+a(I.value)+" sản phẩm):",1),s("span",null,a(g(p)(T.value)),1)]),s("div",mt,[t[48]||(t[48]=s("span",null,"Phí vận chuyển:",-1)),s("span",{class:w(b.value===0?"text-success":"")},a(b.value===0?"Miễn phí":g(p)(b.value)),3)]),b.value===0?(d(),i("div",ct,t[49]||(t[49]=[s("i",{class:"fas fa-check-circle me-1"},null,-1),l(" Bạn được miễn phí vận chuyển! ")]))):v("",!0),t[54]||(t[54]=s("hr",null,null,-1)),s("div",ht,[t[50]||(t[50]=s("strong",{class:"fs-5"},"Tổng cộng:",-1)),s("strong",vt,a(g(p)(y.value)),1)]),s("button",{type:"button",class:"btn btn-primary w-100 mb-2 py-2",onClick:O,disabled:N.value||!U.value},[N.value?(d(),i("span",gt,t[51]||(t[51]=[s("i",{class:"fas fa-spinner fa-spin me-2"},null,-1),l(" Đang xử lý... ")]))):(d(),i("span",ft,t[52]||(t[52]=[s("i",{class:"fas fa-check me-2"},null,-1),l(" Đặt hàng ")])))],8,pt),S(m,{to:"/cart",class:"btn btn-outline-secondary w-100"},{default:q(()=>t[53]||(t[53]=[s("i",{class:"fas fa-arrow-left me-2"},null,-1),l(" Quay lại giỏ hàng ")])),_:1,__:[53]})])])])])])):(d(),i("div",yt,[s("div",bt,[s("div",kt,[t[57]||(t[57]=s("div",{class:"empty-checkout-icon mb-4"},[s("i",{class:"fas fa-exclamation-triangle fa-5x text-warning"})],-1)),t[58]||(t[58]=s("h3",{class:"text-muted mb-3"},"Không có sản phẩm để thanh toán",-1)),t[59]||(t[59]=s("p",{class:"text-muted mb-4"},"Vui lòng quay lại giỏ hàng và chọn sản phẩm để thanh toán",-1)),S(m,{to:"/cart",class:"btn btn-primary btn-lg"},{default:q(()=>t[56]||(t[56]=[s("i",{class:"fas fa-arrow-left me-2"},null,-1),l(" Quay lại giỏ hàng ")])),_:1,__:[56]})])])]))])])}}},wt=H(xt,[["__scopeId","data-v-206d6681"]]);export{wt as default};
